load("~/Documents/Today/.RData")
load("~/Documents/Today/.RData")
setwd("/Volumes/Janaa/Bioinformatics/MicrobiomeDada2")
save(seqtab.nochim, file= "RData/seqtab.nochim.RData")
load("RData/seqtab.nochim.RData")
#downlaod the file https://zenodo.org/records/4587955
taxa <- assignTaxonomy(seqtab.nochim, "silva_nr99_v138.1_wSpecies_train_set.fa.gz" )
library(dada2)
#downlaod the file https://zenodo.org/records/4587955
taxa <- assignTaxonomy(seqtab.nochim, "silva_nr99_v138.1_wSpecies_train_set.fa.gz" )
save.(taxa, file = "RData/taxa.RData")
save(taxa, file = "RData/taxa.RData")
setwd("/Volumes/Janaa/Bioinformatics/MicrobiomeDada2")
source('http://bioconductor.org/biocLite.R')
(!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "3.18")
source('http://bioconductor.org/biocLite.R')
(!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "3.18")
install.packages("BiocManager")
source('http://bioconductor.org/biocLite.R')
R.version.string
(!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "4.3.2")
install.packages("BiocManager")
(!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "4.3")
install.packages("BiocManager")
(!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "3.18")
install.packages("BiocManager")
source('http://bioconductor.org/biocLite.R')
(!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "3.18")
install.packages("BiocManager")
source('http://bioconductor.org/biocLite.R')
(!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "3.18")
install.packages("BiocManager")
source('http://bioconductor.org/biocLite.R')
source("https://raw.githubusercontent.com/joey711/phyloseq/master/inst/scripts/installer.R",
local = TRUE
(!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("phyloseq")
packageVersion('phyloseq')
library(phyloseq)
load("RData/taxa.RData")
load("RData/seqtab.nochim.RData")
metadata <- read.csv("metadata.csv", header+TRUE, row.names = 1)
metadata<- read.csv("metadata.csv", header+TRUE, row.names = 1)
metadata <- read.csv("sample-metadata.csv", header+TRUE, row.names = 1)
metadata <- read.csv("sample-metadata.csv", header=TRUE, row.names = 1)
#make sure the seqtab.nochim and taxa objects are loaded
phyloseq <- phyloseq(otu_table(seqtab.nochim, taxa_are_rows=FALSE), sample_data(metadata), tax_table(taxa)) phyloseq
#make sure the seqtab.nochim and taxa objects are loaded
phyloseq <- phyloseq(otu_table(seqtab.nochim, taxa_are_rows=FALSE), sample_data(metadata), tax_table(taxa))
#make sure the seqtab.nochim and taxa objects are loaded
physeq <- phyloseq(otu_table(seqtab.nochim, taxa_are_rows=FALSE), sample_data(metadata),tax_table(taxa))
physeq
#convert from raw to abundance
physeq <- transform_sample_counts(physeq, function(abund) 1*(abund>0))
physeq
dna <- Biostrings::DNAStringSet(taxa_names(physeq))
names(dna) <- taxa_names(physeq)
physeq <- merge_phyloseq(physeq, dna)
taxa_names(physeq) <- paste0("ASV", seq(ntaxa(physeq)))
physeq
#stictly use bacteria 16S rRNA,
physeq <- %>% subset_taxa(Family! = "Mitochondria" | is.na(Family) & Order!="Chloroplast" | is.na(Order) )
library(phyloseq)
library(dpylr)
library(phyloseq)
library(dplyr)
#stictly use bacteria 16S rRNA,
physeq <- %>% subset_taxa(Family! = "Mitochondria" | is.na(Family) & Order!="Chloroplast" | is.na(Order) )
#stictly use bacteria 16S rRNA,
physeq <- %>% subset_taxa(Family! = "Mitochondria" | is.na(Family) & Order!="Chloroplast" | is.na(Order) )
library(phyloseq)
library(dplyr)
library(magrittr)
#stictly use bacteria 16S rRNA,
physeq <- %>% subset_taxa(Family! = "Mitochondria" | is.na(Family) & Order!="Chloroplast" | is.na(Order) )
#stictly use bacteria 16S rRNA,
physeq <- %>% subset_taxa(Family! = "Mitochondria" | is.na(Family) & Order!="Chloroplast" | is.na(Order) )
#stictly use bacteria 16S rRNA,
physeq <- physeq %>% subset_taxa(Family! = "Mitochondria" | is.na(Family) & Order!="Chloroplast" | is.na(Order))
library(phyloseq)
library(dplyr)
#stictly use bacteria 16S rRNA,
physeq <- physeq %>% subset_taxa(Family! = "Mitochondria" | is.na(Family) & Order!="Chloroplast" | is.na(Order))
#stictly use bacteria 16S rRNA,
physeq <- physeq %>% subset_taxa( Family! = "Mitochondria" | is.na(Family) & Order!="Chloroplast" | is.na(Order))
#stictly use bacteria 16S rRNA,
physeq <- physeq %>% subset_taxa( Family!= "Mitochondria" | is.na(Family) & Order!="Chloroplast" | is.na(Order))
physeq
physeq <-rm_nonbac(physeq)
physeq<-rm_nonbac(physeq)
View(seqtab.nochim)
View(taxa)
install.packages("remotes")
remotes::install_github("peterolah001/BiMiCo")
library(phyloseq)
library(dplyr)
library(BiMico)
library(phyloseq)
library(dplyr)
library(BiMiCo)
physeq<-rm_nonbac(physeq)
physeq
save(physeq, file= "RData/physeq.RData")
View(taxa)
R.version.string
setwd("/Volumes/Janaa/Bioinformatics/MicrobiomeDada2")
library(phyloseq)
library(dplyr)
library(BiMiCo)
library(ggplot2)
library(devtools)
library(MicEco)
braysubject=plot_ordination(physeqprune, ordination, color="subject") +
theme_classic() +
theme(strip.background = element_blank()) + stat_ellipse(aes(group=subject))
load("RData/physeq.RData")
minTotRelAbun = .00005
x = taxa_sums(physeq)
keepTaxa = (x / sum(x)) > minTotRelAbun
physeqprune = prune_taxa(keepTaxa, physeq)
physeqprune
#create a ven diagram showing the different categories and what they share
bodysite=ps_venn(
physeqprune,
"body.site",
fraction = .25,
weight = FALSE,
relative = TRUE,
plot = TRUE)
bodysite
set.seed(666)
dist = phyloseq::distance(physeqprune, method="bray", weighted=TRUE)
ordination = ordinate(physeqprune, method="NMDS", distance=dist)
braysubject=plot_ordination(physeqprune, ordination, color="subject") +
theme_classic() +
theme(strip.background = element_blank()) + stat_ellipse(aes(group=subject))
braysubject
braysubject=plot_ordination(physeqprune, ordination, color="body.site") +
theme_classic() +
theme(strip.background = element_blank()) + stat_ellipse(aes(group=body.site))
braybodysite
braysubject=plot_ordination(physeqprune, ordination, color="body.site") +
theme_classic() +
theme(strip.background = element_blank()) + stat_ellipse(aes(group=body.site))
braybody.site
braysubject=plot_ordination(physeqprune, ordination, color="body.site") +
theme_classic() +
theme(strip.background = element_blank()) + stat_ellipse(aes(group=body.site))
braybodysite
braysubject=plot_ordination(physeqprune, ordination, color="body.site") +
theme_classic() +
theme(strip.background = element_blank()) + stat_ellipse(aes(group=body.site))
braybodysite
braysubject=plot_ordination(physeqprune, ordination, color="body.site") +
theme_classic() +
theme(strip.background = element_blank()) + stat_ellipse(aes(group=body.site))
braysubject
braybodysite=plot_ordination(physeqprune, ordination, color="body.site") +
theme_classic() +
theme(strip.background = element_blank()) + stat_ellipse(aes(group=body.site))
braybodysite
brayabusage=plot_ordination(physeqprune, ordination, color="reported.antibiotic.usage") +
theme_classic() +
theme(strip.background = element_blank()) + stat_ellipse(aes(group=reported.antibiotic.usage))
brayabusage
braybodysite=plot_ordination(physeqprune, ordination, color="body.site") +
theme_classic() +
theme(strip.background = element_blank()) + stat_ellipse(aes(group=body.site))
braybodysite
install.packages("vegan")
install.packages("vegan")
install.packages("vegan")
install.packages("vegan")
library(phyloseq)
library(dplyr)
library(BiMiCo)
library(ggplot2)
library(devtools)
library(MicEco)
library(vegan)
adonisZ(dist - sample_data(physeqprune)$subject)
adonis2(dist - sample_data(physeqprune)$subject)
adonis2(dist - sample_data(physeqprune)$subject)
adonis2(dist - sample_data(physeqprune)$body.site)
adonis2(dist ~ sample_data(physeqprune)$body.site)
ps.disper<-betadisper(dist, sample_data(physeqprune)$body.site)
permutest(ps.disper, pair=TRUE)
adonis2(dist ~ sample_data(physeqprune)$subject)
adonis2(dist ~ sample_data(physeqprune)$subject)
adonis2(dist ~ sample_data(physeqprune)$reported.antibiotic.usage)
ggsave(
filename= "Fig1.tiff",
plot = braybodysite,
width = 200
height = 200
ggsave(
filename= "Fig1.tiff",
plot = braybodysite,
width = 200,
height = 200,
units = c("mm"),
dpi = 300
ggsave(
filename= "Fig1.tiff",
plot = braybodysite,
width = 200,
height = 200,
units = "mm",
dpi = 300
ggsave(
filename= "Fig1.tiff",
plot = braybodysite,
width = 200,
height = 200,
units = "mm",
dpi = 300
